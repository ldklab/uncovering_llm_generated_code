The Node.js code is set up to assist with determining JavaScript feature support across different browser targets defined with "browserslist" query syntax. Here's how the code functions:

1. **Dependencies and Setup**:
   - The `browserslist` package is used to parse browser queries and return a list of browser versions.
   - The `@mdn/browser-compat-data` package is used to get compatibility data for JavaScript features.

2. **Main Functions**:
   - `getCompilationTargets(query)`: This function takes a `browserslist` query and returns a list of target browsers and versions from that query.
   - `isFeatureSupported(feature, query)`: Given a JavaScript feature and a `browserslist` query, this function checks if the feature is supported by all browser targets in the query. It throws an error if the feature is unknown.
   - `listSupportedFeatures(query)`: This function returns a list of all JavaScript features that are supported by all browsers specified in the query.

3. **Test Script**:
   - The `tests.js` file imports the functions and demonstrates their use with a sample query (`'> 0.25%, not dead'`). It prints the compilation targets, checks if arrow functions are supported, and lists all supported features.

Below is a rewritten version of the Node.js code provided:

```json
// package.json
{
  "name": "@babel/helper-compilation-targets",
  "version": "1.0.0",
  "main": "index.js",
  "description": "Helper functions on Babel compilation targets",
  "scripts": {
    "test": "node tests.js"
  },
  "author": "",
  "license": "MIT"
}

// index.js
const browserslist = require('browserslist');
const { javascript: { features } } = require('@mdn/browser-compat-data');

function getCompilationTargets(query) {
  return browserslist(query);
}

function isFeatureSupported(feature, query) {
  const targets = getCompilationTargets(query);
  
  if (!features[feature]) {
    throw new Error(`Unknown feature: ${feature}`);
  }
  
  return targets.every(target => {
    const [browser, version] = target.split(' ');
    const browserSupport = features[feature].__compat.support[browser];
    
    if (!browserSupport || !('version_added' in browserSupport)) {
      return false;
    }
    
    return parseFloat(version) >= parseFloat(browserSupport.version_added);
  });
}

function listSupportedFeatures(query) {
  return Object.keys(features)
    .filter(feature => isFeatureSupported(feature, query));
}

module.exports = {
  getCompilationTargets,
  isFeatureSupported,
  listSupportedFeatures
};

// tests.js
const { getCompilationTargets, isFeatureSupported, listSupportedFeatures } = require('./index');

const testQuery = '> 0.25%, not dead';

console.log('Compilation Targets:', getCompilationTargets(testQuery));
console.log('Is arrow functions supported:', isFeatureSupported('arrow-functions', testQuery));
console.log('Supported features:', listSupportedFeatures(testQuery));
```