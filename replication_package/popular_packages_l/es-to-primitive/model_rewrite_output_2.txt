The provided Node.js code defines a function `toPrimitive` that attempts to convert an object input into a primitive value, either a string or a number, depending upon a preferred type. The logic involves calling the object's `toString` or `valueOf` methods to derive a primitive. If the `preferredType` is 'string', it tries `toString` first, otherwise, it tries `valueOf`. If neither method converts the object successfully, a `TypeError` is thrown.

Two convenience functions, `toPrimitiveES5` and `toPrimitiveES2015`, call `toPrimitive` with the current JavaScript version in mind. These functions essentially serve as wrappers for `toPrimitive`.

The module exports `toPrimitiveES2015` as the default, indicating the most recent implementation, while also exporting each wrapper function for potential specific compatibility needs.

There's a small section for automated example testing. If the script is executed directly, it runs a set of assertions to verify the functionality.

Here is the rewritten code:

```javascript
'use strict';

function toPrimitive(input, preferredType) {
    if (typeof input !== 'object' || input === null) {
        return input; // Return primitive as-is
    }
    
    const methodNames = preferredType === 'string' ? ['toString', 'valueOf'] : ['valueOf', 'toString'];
    
    for (const methodName of methodNames) {
        const method = input[methodName];
        if (typeof method === 'function') {
            const result = method.call(input);
            if (typeof result !== 'object' || result === null) {
                return result; // Return first valid primitive result
            }
        }
    }
    
    throw new TypeError("Cannot convert object to primitive value");
}

function toPrimitiveES5(input) {
    return toPrimitive(input); // ES5 logic
}

function toPrimitiveES2015(input) {
    return toPrimitive(input); // ES2015 logic
}

module.exports = toPrimitiveES2015;
module.exports.es5 = toPrimitiveES5;
module.exports.es2015 = toPrimitiveES2015;

// Example Usage
if (require.main === module) {
    const assert = require('assert');

    assert.strictEqual(toPrimitive(function () {}), String(function () {}));
    
    const date = new Date();
    assert.strictEqual(toPrimitive(date), String(date));
    
    assert.strictEqual(toPrimitive({ valueOf: function () { return 3; } }), 3);
    
    assert.strictEqual(toPrimitive(['a', 'b', 3]), String(['a', 'b', 3]));
    
    const sym = Symbol();
    assert.strictEqual(toPrimitive(Object(sym)), sym);
}
```