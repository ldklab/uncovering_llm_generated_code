The functionality of the provided Node.js code is to check if the current module is the main module (i.e., if it's being run directly from the command line). If it is the main module, it executes a CLI interface from a `cli.js` file located in a `lib` directory and passes the `process` object to it. Conversely, if the module is not the main module (meaning it's being required by another module), it throws an error indicating that a programmatic API feature was removed in npm version 8.0.0. This suggests that the code is intended to be run only as a standalone command-line application and not to be used as a library or module in other codebases.

Here's a rewrite of the code following the same functionality:

```javascript
// Check if the current module is the entry point of the application
if (require.main === module) {
  // Execute the command-line interface code by passing the process object
  const cli = require('./lib/cli.js');
  cli(process);
} else {
  // Throw an error if this module is not used as the main module
  throw new Error('The programmatic API was removed in npm v8.0.0');
}
```