The provided Node.js code defines a module that exports functionality related to URL handling and percent encoding. It utilizes several imported modules, including a WebIDL bindings wrapper and a URL state machine. Here's a breakdown of its functionality:

1. **Imports**: 
   - `URL` and `URLSearchParams` are imported from the `webidl2js-wrapper` to use WebIDL bindings for URL manipulation.
   - `urlStateMachine` and `percentEncoding` are imported from respective files to handle URL state machine operations and percent encoding/decoding.

2. **Installing URL and URLSearchParams**:
   - Using the WebIDL bindings (`URL.install` and `URLSearchParams.install`), it initializes `URL` and `URLSearchParams` in a shared global object, specifying that they are to be installed in a "Window" context.

3. **Exports**:
   - The module exports `URL` and `URLSearchParams` from the `sharedGlobalObject`.
   - Functions from `urlStateMachine` provide detailed operations for parsing and serializing URLs (such as `parseURL`, `basicURLParse`, `serializeURL`, etc.).
   - Functions from `percentEncoding` provide operations for decoding percent-encoded strings and bytes.

Here's a possible rewrite of the original code:

```javascript
"use strict";

const { URL, URLSearchParams } = require("./webidl2js-wrapper");
const {
  parseURL,
  basicURLParse,
  serializeURL,
  serializePath,
  serializeHost,
  serializeInteger,
  serializeURLOrigin,
  setTheUsername,
  setThePassword,
  cannotHaveAUsernamePasswordPort,
  hasAnOpaquePath
} = require("./lib/url-state-machine");
const {
  percentDecodeString,
  percentDecodeBytes
} = require("./lib/percent-encoding");

const sharedGlobalObject = { Array, Object, Promise, String, TypeError };

URL.install(sharedGlobalObject, ["Window"]);
URLSearchParams.install(sharedGlobalObject, ["Window"]);

exports.URL = sharedGlobalObject.URL;
exports.URLSearchParams = sharedGlobalObject.URLSearchParams;

exports.parseURL = parseURL;
exports.basicURLParse = basicURLParse;
exports.serializeURL = serializeURL;
exports.serializePath = serializePath;
exports.serializeHost = serializeHost;
exports.serializeInteger = serializeInteger;
exports.serializeURLOrigin = serializeURLOrigin;
exports.setTheUsername = setTheUsername;
exports.setThePassword = setThePassword;
exports.cannotHaveAUsernamePasswordPort = cannotHaveAUsernamePasswordPort;
exports.hasAnOpaquePath = hasAnOpaquePath;

exports.percentDecodeString = percentDecodeString;
exports.percentDecodeBytes = percentDecodeBytes;
```