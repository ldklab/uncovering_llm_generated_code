The provided Node.js code defines a function that creates an instance of a processor based on the `content-type` header from a configuration object. This involves extracting and verifying the `content-type` header, matching it against a list of supported types (`TYPES`), and then instantiating the appropriate processor. Two types are explicitly required for this purpose: `multipart` and `urlencoded`, each of which should have a `detect` method to verify compatibility with the `content-type`. If the `content-type` is valid and supported, an instance is created with configuration details; if not, an error is thrown.

The main exported function checks if the configuration object is valid and calls `getInstance` to handle the processing logic.

Here's the rewritten code:

```javascript
'use strict';

const { parseContentType } = require('./utils.js');

const TYPES = [
  require('./types/multipart'),
  require('./types/urlencoded'),
].filter(typeModule => typeof typeModule.detect === 'function');

function getInstance(config) {
  const headers = config.headers;
  const contentTypeHeader = headers['content-type'];
  const parsedContentType = parseContentType(contentTypeHeader);

  if (!parsedContentType) {
    throw new Error('Malformed content type');
  }

  for (const type of TYPES) {
    if (type.detect(parsedContentType)) {
      const instanceConfig = {
        limits: config.limits,
        headers,
        conType: parsedContentType,
        highWaterMark: config.highWaterMark,
        fileHwm: config.fileHwm,
        defCharset: config.defCharset,
        defParamCharset: config.defParamCharset,
        preservePath: config.preservePath || false,
      };
      return new type(instanceConfig);
    }
  }

  throw new Error(`Unsupported content type: ${contentTypeHeader}`);
}

module.exports = (config) => {
  if (typeof config !== 'object' || config === null) {
    config = {};
  }

  const headers = config.headers;
  const contentTypeHeader = headers?.['content-type'];

  if (typeof headers !== 'object' || !contentTypeHeader) {
    throw new Error('Missing Content-Type');
  }

  return getInstance(config);
};
```