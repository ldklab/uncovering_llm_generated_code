The given Node.js code is a module system implementation to export functions, facilitating both CommonJS and ESM (ECMAScript Module) interoperability. It defines utilities for handling properties and exporting objects. The main functional components include:

1. **Helper Functions:**
   - `__defProp`: Shortcut for `Object.defineProperty`.
   - `__getOwnPropDesc`: Retrieves property descriptors.
   - `__getOwnPropNames`: Obtains names of properties on an object.
   - `__hasOwnProp`: Checks if a property exists on an object.

2. **`__name`**: Sets the `name` property on a target function or method, making it configurable for flexibility.

3. **Export function (`__export`)**: Loops over an object to define properties on a target object, making functions and properties accessible.

4. **Property Copier (`__copyProps`)**: Copies properties from one object to another, avoiding exceptions, and handles descriptors to maintain enumerability.

5. **`__toCommonJS`**: Adapts modules for CommonJS by defining the `__esModule` property, enabling named exports to be compatible with ES module imports.

6. **Primary Exports (`src_exports`)**:
   - `getSmithyContext`: A function to retrieve or initialize a context keyed by `SMITHY_CONTEXT_KEY`.
   - `normalizeProvider`: Ensures provided input becomes a promise-returning function, aiding asynchronous behavior or accepting direct return values.

7. **Module Export**: Exports the generated `src_exports` object for use in other modules, particularly for environments requiring CommonJS compatibility.

Below is the rewritten Node.js code:

```javascript
// Helper functions for property definitions and retrievals
const defineProperty = Object.defineProperty;
const getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;
const getOwnPropertyNames = Object.getOwnPropertyNames;
const hasOwnProperty = Object.prototype.hasOwnProperty;

// Function to assign a configurable name to a function or method
const assignName = (target, value) =>
  defineProperty(target, "name", { value, configurable: true });

// Function to export properties of an object
const exportProperties = (target, exports) => {
  for (let name in exports) {
    defineProperty(target, name, { get: exports[name], enumerable: true });
  }
};

// Function to copy properties from one object to another, with exceptions
const copyProperties = (to, from, except, desc) => {
  if (from && (typeof from === "object" || typeof from === "function")) {
    for (let key of getOwnPropertyNames(from)) {
      if (!hasOwnProperty.call(to, key) && key !== except) {
        defineProperty(to, key, {
          get: () => from[key],
          enumerable: !(desc = getOwnPropertyDescriptor(from, key)) || desc.enumerable,
        });
      }
    }
  }
  return to;
};

// Function to wrap a module for CommonJS compatibility
const toCommonJS = (module) =>
  copyProperties(defineProperty({}, "__esModule", { value: true }), module);

// Exported functions
const srcExports = {};
exportProperties(srcExports, {
  getSmithyContext: () => getSmithyContext,
  normalizeProvider: () => normalizeProvider,
});
module.exports = toCommonJS(srcExports);

// Importing required dependencies
const { SMITHY_CONTEXT_KEY } = require("@smithy/types");

// getSmithyContext function
const getSmithyContext = /* @__PURE__ */ assignName((context) =>
  context[SMITHY_CONTEXT_KEY] || (context[SMITHY_CONTEXT_KEY] = {}), "getSmithyContext");

// normalizeProvider function
const normalizeProvider = /* @__PURE__ */ assignName((input) => {
  if (typeof input === "function") return input;
  const promisified = Promise.resolve(input);
  return () => promisified;
}, "normalizeProvider");

// Note: Annotate the CommonJS export names for ESM import in node:
0 && (module.exports = { getSmithyContext, normalizeProvider });
```

This refactor maintains the same functionality while enhancing readability by clarifying function roles and leveraging modern syntax where possible.